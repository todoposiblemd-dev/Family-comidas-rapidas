<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inventario ‚Äì Family Comidas R√°pidas</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: Arial, sans-serif;
    background: #f5f5f5;
    padding: 10px;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.header {
    text-align: center;
    padding: 25px 20px;
    background: #dc143c;
    color: white;
    border-radius: 10px 10px 0 0;
}

.header h1 {
    font-size: 28px;
    margin: 0 0 8px 0;
    letter-spacing: 1px;
}

.header p {
    font-size: 16px;
    margin: 0;
    opacity: 0.95;
}

.controls {
    padding: 15px;
    background: #f8f8f8;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    flex: 1;
    min-width: 140px;
}

.btn-success { background: #28a745; color: white; }
.btn-primary { background: #007bff; color: white; }
.btn-warning { background: #ffc107; color: #333; }
.btn-danger { background: #dc3545; color: white; }

.content {
    padding: 15px;
}

.category {
    margin-bottom: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
}

.category-title {
    background: #dc143c;
    color: white;
    padding: 12px 15px;
    font-size: 18px;
    font-weight: bold;
}

.product-item {
    padding: 15px;
    border-bottom: 1px solid #eee;
}

.product-item:last-child {
    border-bottom: none;
}

.product-name {
    font-weight: bold;
    font-size: 16px;
    margin-bottom: 10px;
    color: #333;
}

.product-controls {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 10px;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-group label {
    font-size: 12px;
    color: #666;
    margin-bottom: 4px;
}

.form-group input,
.form-group select {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
}

.form-group input[type="checkbox"] {
    width: 24px;
    height: 24px;
    margin: 5px 0;
}

.product-actions {
    display: flex;
    gap: 5px;
    margin-top: 10px;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 12px;
    flex: 1;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    overflow-y: auto;
}

.modal-content {
    background: white;
    margin: 20px auto;
    padding: 20px;
    border-radius: 10px;
    max-width: 500px;
    width: 90%;
}

.modal-content h2 {
    margin-bottom: 15px;
    color: #333;
}

.modal-form-group {
    margin-bottom: 12px;
}

.modal-form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #555;
}

.modal-form-group input,
.modal-form-group select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 14px;
}

.modal-buttons {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.unit-input-group {
    display: flex;
    gap: 5px;
    align-items: flex-end;
}

.unit-input-group select {
    flex: 2;
}

.unit-input-group input {
    flex: 1;
    display: none;
}

.unit-input-group input.show {
    display: block;
}

.footer {
    text-align: center;
    padding: 15px;
    background: #f8f8f8;
    color: #666;
    font-size: 12px;
    border-radius: 0 0 10px 10px;
}

@media (max-width: 600px) {
    .product-controls {
        grid-template-columns: 1fr;
    }
    .controls {
        flex-direction: column;
    }
    .btn {
        width: 100%;
        min-width: auto;
    }
}
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>CONTROL DE INVENTARIOS</h1>
        <p>Family Comidas R√°pidas</p>
    </div>

    <div class="controls">
        <button class="btn btn-success" onclick="openAddModal()">‚ûï Agregar</button>
        <button class="btn btn-primary" onclick="exportToExcel()">üìä Excel</button>
        <button class="btn btn-warning" onclick="saveData()">üíæ Guardar</button>
    </div>

    <div class="content" id="inventory-content"></div>

    <div class="footer">
        Family Comidas R√°pidas ¬© 2026
    </div>
</div>

<div id="productModal" class="modal">
    <div class="modal-content">
        <h2 id="modalTitle">Agregar Producto</h2>
        <form id="productForm" onsubmit="return submitProduct(event)">
            <div class="modal-form-group">
                <label>Categor√≠a:</label>
                <select id="productCategory" required>
                    <option value="">Seleccione...</option>
                    <option value="Prote√≠nas">Prote√≠nas</option>
                    <option value="Panes y Bases">Panes y Bases</option>
                    <option value="L√°cteos">L√°cteos</option>
                    <option value="Acompa√±amientos">Acompa√±amientos</option>
                    <option value="Bebidas">Bebidas</option>
                </select>
            </div>
            <div class="modal-form-group">
                <label>Producto:</label>
                <input type="text" id="productName" required>
            </div>
            <div class="modal-form-group">
                <label>Unidad de Medida:</label>
                <div class="unit-input-group">
                    <select id="productUnit" onchange="toggleCustomUnit()">
                        <option value="kg">Kilogramos (kg)</option>
                        <option value="g">Gramos (g)</option>
                        <option value="lb">Libras (lb)</option>
                        <option value="unidad">Unidades</option>
                        <option value="litro">Litros (L)</option>
                        <option value="ml">Mililitros (ml)</option>
                        <option value="docena">Docenas</option>
                        <option value="paquete">Paquetes</option>
                        <option value="caja">Cajas</option>
                        <option value="otro">Otra...</option>
                    </select>
                    <input type="text" id="customUnit" placeholder="Escribe la unidad">
                </div>
            </div>
            <div class="modal-form-group">
                <label>¬øSe maneja?</label>
                <select id="productActive" required>
                    <option value="true">S√≠</option>
                    <option value="false">No</option>
                </select>
            </div>
            <div class="modal-form-group">
                <label>Cantidad M√≠nima:</label>
                <input type="number" id="productMin" step="0.01" min="0">
            </div>
            <div class="modal-form-group">
                <label>Cantidad M√°xima:</label>
                <input type="number" id="productMax" step="0.01" min="0">
            </div>
            <div class="modal-buttons">
                <button type="submit" class="btn btn-success">Guardar</button>
                <button type="button" class="btn btn-danger" onclick="closeModal()">Cancelar</button>
            </div>
        </form>
    </div>
</div>

<script>
var inventoryData = {
    "Prote√≠nas": [
        { name: "Carne de res molida", unit: "kg", active: false, min: "", max: "" },
        { name: "Pollo", unit: "kg", active: false, min: "", max: "" },
        { name: "Pollo desmechado", unit: "kg", active: false, min: "", max: "" },
        { name: "Salchicha", unit: "unidad", active: false, min: "", max: "" },
        { name: "Chorizo", unit: "unidad", active: false, min: "", max: "" }
    ],
    "Panes y Bases": [
        { name: "Pan artesanal", unit: "unidad", active: false, min: "", max: "" },
        { name: "Pan franc√©s", unit: "unidad", active: false, min: "", max: "" },
        { name: "Tortillas de trigo", unit: "paquete", active: false, min: "", max: "" }
    ],
    "L√°cteos": [
        { name: "Queso mozzarella", unit: "kg", active: false, min: "", max: "" },
        { name: "Queso crema", unit: "g", active: false, min: "", max: "" }
    ],
    "Acompa√±amientos": [
        { name: "Papa francesa", unit: "kg", active: false, min: "", max: "" },
        { name: "Papa criolla", unit: "kg", active: false, min: "", max: "" }
    ],
    "Bebidas": [
        { name: "Gaseosas", unit: "unidad", active: false, min: "", max: "" },
        { name: "Jugos", unit: "litro", active: false, min: "", max: "" },
        { name: "Agua", unit: "litro", active: false, min: "", max: "" }
    ]
};

var editingProduct = null;
var customUnits = [];

window.onload = function() {
    try {
        var saved = localStorage.getItem('familyInventory');
        if (saved) {
            inventoryData = JSON.parse(saved);
        }
        var savedUnits = localStorage.getItem('customUnits');
        if (savedUnits) {
            customUnits = JSON.parse(savedUnits);
            updateUnitOptions();
        }
    } catch(e) {
        console.log('No hay datos guardados');
    }
    renderInventory();
};

function updateUnitOptions() {
    var unitSelect = document.getElementById('productUnit');
    var otroOption = unitSelect.querySelector('option[value="otro"]');
    
    customUnits.forEach(function(unit) {
        var exists = false;
        for (var i = 0; i < unitSelect.options.length; i++) {
            if (unitSelect.options[i].value === unit) {
                exists = true;
                break;
            }
        }
        if (!exists) {
            var option = document.createElement('option');
            option.value = unit;
            option.textContent = unit;
            unitSelect.insertBefore(option, otroOption);
        }
    });
}

function toggleCustomUnit() {
    var select = document.getElementById('productUnit');
    var customInput = document.getElementById('customUnit');
    
    if (select.value === 'otro') {
        customInput.classList.add('show');
        customInput.required = true;
    } else {
        customInput.classList.remove('show');
        customInput.required = false;
    }
}

function renderInventory() {
    var content = document.getElementById('inventory-content');
    content.innerHTML = '';
    
    for (var category in inventoryData) {
        var products = inventoryData[category];
        
        var categoryDiv = document.createElement('div');
        categoryDiv.className = 'category';
        
        var html = '<div class="category-title">' + category + '</div>';
        
        for (var i = 0; i < products.length; i++) {
            var p = products[i];
            var unitDisplay = p.unit || 'unidad';
            
            html += '<div class="product-item">';
            html += '<div class="product-name">' + p.name + ' (' + unitDisplay + ')</div>';
            html += '<div class="product-controls">';
            html += '<div class="form-group">';
            html += '<label>¬øSe maneja?</label>';
            html += '<input type="checkbox" ' + (p.active ? 'checked' : '') + ' onchange="toggleProduct(\'' + category + '\', ' + i + ')">';
            html += '</div>';
            html += '<div class="form-group">';
            html += '<label>Cant. M√≠nima</label>';
            html += '<input type="number" value="' + (p.min || '') + '" onchange="updateField(\'' + category + '\', ' + i + ', \'min\', this.value)">';
            html += '</div>';
            html += '<div class="form-group">';
            html += '<label>Cant. M√°xima</label>';
            html += '<input type="number" value="' + (p.max || '') + '" onchange="updateField(\'' + category + '\', ' + i + ', \'max\', this.value)">';
            html += '</div>';
            html += '</div>';
            html += '<div class="product-actions">';
            html += '<button class="btn btn-primary btn-sm" onclick="editProduct(\'' + category + '\', ' + i + ')">‚úèÔ∏è Editar</button>';
            html += '<button class="btn btn-danger btn-sm" onclick="deleteProduct(\'' + category + '\', ' + i + ')">üóëÔ∏è Eliminar</button>';
            html += '</div>';
            html += '</div>';
        }
        
        categoryDiv.innerHTML = html;
        content.appendChild(categoryDiv);
    }
}

function toggleProduct(category, index) {
    inventoryData[category][index].active = !inventoryData[category][index].active;
}

function updateField(category, index, field, value) {
    inventoryData[category][index][field] = value;
}

function saveData() {
    try {
        localStorage.setItem('familyInventory', JSON.stringify(inventoryData));
        localStorage.setItem('customUnits', JSON.stringify(customUnits));
        alert('‚úÖ Guardado correctamente');
    } catch(e) {
        alert('Error al guardar: ' + e.message);
    }
}

function openAddModal() {
    editingProduct = null;
    document.getElementById('modalTitle').textContent = 'Agregar Producto';
    document.getElementById('productForm').reset();
    document.getElementById('customUnit').classList.remove('show');
    document.getElementById('productModal').style.display = 'block';
}

function editProduct(category, index) {
    editingProduct = { category: category, index: index };
    var product = inventoryData[category][index];
    
    document.getElementById('modalTitle').textContent = 'Editar Producto';
    document.getElementById('productCategory').value = category;
    document.getElementById('productName').value = product.name;
    document.getElementById('productActive').value = product.active.toString();
    document.getElementById('productMin').value = product.min;
    document.getElementById('productMax').value = product.max;
    
    var unitSelect = document.getElementById('productUnit');
    var unitExists = false;
    for (var i = 0; i < unitSelect.options.length; i++) {
        if (unitSelect.options[i].value === product.unit) {
            unitSelect.value = product.unit;
            unitExists = true;
            break;
        }
    }
    
    if (!unitExists && product.unit) {
        unitSelect.value = 'otro';
        document.getElementById('customUnit').value = product.unit;
        toggleCustomUnit();
    }
    
    document.getElementById('productModal').style.display = 'block';
}

function deleteProduct(category, index) {
    if (confirm('¬øEliminar este producto?')) {
        inventoryData[category].splice(index, 1);
        renderInventory();
        saveData();
    }
}

function closeModal() {
    document.getElementById('productModal').style.display = 'none';
}

function submitProduct(event) {
    event.preventDefault();
    
    var category = document.getElementById('productCategory').value;
    var unitSelect = document.getElementById('productUnit');
    var unit = unitSelect.value;
    
    if (unit === 'otro') {
        unit = document.getElementById('customUnit').value.trim();
        if (unit && customUnits.indexOf(unit) === -1) {
            customUnits.push(unit);
            updateUnitOptions();
        }
    }
    
    var product = {
        name: document.getElementById('productName').value,
        unit: unit,
        active: document.getElementById('productActive').value === 'true',
        min: document.getElementById('productMin').value,
        max: document.getElementById('productMax').value
    };
    
    if (editingProduct) {
        inventoryData[editingProduct.category][editingProduct.index] = product;
    } else {
        if (!inventoryData[category]) {
            inventoryData[category] = [];
        }
        inventoryData[category].push(product);
    }
    
    renderInventory();
    saveData();
    closeModal();
    return false;
}

window.onclick = function(event) {
    var modal = document.getElementById('productModal');
    if (event.target == modal) {
        closeModal();
    }
};

function exportToExcel() {
    if (typeof XLSX === 'undefined') {
        alert('Error: No se puede exportar. Verifique su conexi√≥n a internet.');
        return;
    }
    
    var data = [['Categor√≠a', 'Producto', 'Unidad', '¬øSe maneja?', 'Cant. M√≠nima', 'Cant. M√°xima']];
    
    for (var category in inventoryData) {
        var products = inventoryData[category];
        for (var i = 0; i < products.length; i++) {
            var p = products[i];
            data.push([
                category,
                p.name,
                p.unit || 'unidad',
                p.active ? 'S√≠' : 'No',
                p.min || '',
                p.max || ''
            ]);
        }
    }
    
    var ws = XLSX.utils.aoa_to_sheet(data);
    ws['!cols'] = [
        { wch: 20 },
        { wch: 30 },
        { wch: 15 },
        { wch: 12 },
        { wch: 15 },
        { wch: 15 }
    ];
    
    var wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Inventario');
    
    var fecha = new Date().toISOString().split('T')[0];
    XLSX.writeFile(wb, 'Inventario_Family_' + fecha + '.xlsx');
}
</script>

</body>
</html>